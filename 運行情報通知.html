<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="jquery-3.7.1.min.js"></script>
	<script src="https://unpkg.com/obniz@3.24.0/obniz.js"></script>
</head>
<script>
//let obniz = new Obniz("7571-8342");  //自分のobnizの番号に書き換えて下さい
//②ここに必要な変数宣言を書きます  
//let fLED;
//obniz.onconnect = async function () {
//③ここに様々なJavaScriptの処理を書きます  
//fLED = obniz.wired("WS2811", {gnd:9, vcc:10, din:11});
//fLED.rgb(255, 255, 255); */
//運行情報通知
$.get("https://isclabo.thick.jp/train_all.php",
	function(data){
		//コンソール基本情報取得
		let lastupdeted = data.lastUpdated;
		console.log(lastupdeted);
		//1路線目取得
		//地域選択
		let selectElem1 = document.getElementById("areaSelect1");
		selectElem1.addEventListener("change", () => {
			let selectedArea1No = selectElem1.selectedIndex;
			let selecteddata1 = $("#areaSelect1").children("option:selected");
			let selectedArea1Txt = selecteddata1.text();
			$("#areaSelected1").text('１路線目の地域：'+selectedArea1Txt)
			let lineCompany1 = data.data[selectedArea1No+1][0].companyName;
			let lineName1 = data.data[selectedArea1No+1][0].railName;
			let lineInformation1 = data.data[selectedArea1No+1][0].status;
			console.log(lineCompany1);
			console.log(lineName1);
			console.log(lineInformation1);
			//1路線目基本情報
				if (lineName1.indexOf(lineCompany1) !== -1){
					$("#lineCompany1").hide();
					} else {
					$("#lineCompany1").text(lineCompany1+'の');
				}
			$("#lineName1").text(lineName1+'は');
			//1路線目運行情報
			switch (lineInformation1){
				case '平常運転':
				$("#lineInformation1").text('平常運転中です').css("color","seagreen");
				//fLED.rgb(  0, 255,   0);
				break;
				case '列車遅延':
				case '運転状況':
				case '運転再開':
				$("#lineInformation1").text('ダイヤが乱れています').css("color","gold");
				//fLED.rgb(255, 128,   0);
				break;
				case '運転見合わせ':
				$("#lineInformation1").text('運転見合わせしています').css("color","crimson");
				//fLED.rgb(255,   0,   0);
				break;
				case '運転情報':
				case '運転計画':
				case 'その他':
				$("#lineInformation1").text('時刻表通りに運転しないなどの可能性があります').css("color","slategray");
				//fLED.rgb(255, 255, 255);
			}
		});
		//2路線目取得
		//地域選択
		let selectElem2 = document.getElementById("areaSelect2");
		selectElem2.addEventListener("change", () => {
			let selectedArea2No = selectElem2.selectedIndex;
			let selecteddata2 = $("#areaSelect2").children("option:selected");
			let selectedArea2Txt = selecteddata2.text();
			$("#areaSelected2").text('２路線目の地域：'+selectedArea2Txt)
			let lineCompany2 = data.data[selectedArea2No+1][0].companyName;
			let lineName2 = data.data[selectedArea2No+1][0].railName;
			let lineInformation2 = data.data[selectedArea2No+1][0].status;
			console.log(lineCompany2);
			console.log(lineName2);
			console.log(lineInformation2);
			//2路線目基本情報
				if (lineName2.indexOf(lineCompany2) !== -1){
					$("#lineCompany2").hide();
					} else {
					$("#lineCompany2").text(lineCompany2+'の');
				}
			$("#lineName2").text(lineName2+'は');
			//2路線目運行情報
			switch (lineInformation2){
				case '平常運転':
				$("#lineInformation2").text('平常運転中です').css("color","seagreen");
				//fLED.rgb(  0, 255,   0);
				break;
				case '列車遅延':
				case '運転状況':
				case '運転再開':
				$("#lineInformation2").text('ダイヤが乱れています').css("color","gold");
				//fLED.rgb(255, 128,   0);
				break;
				case '運転見合わせ':
				$("#lineInformation2").text('運転見合わせしています').css("color","crimson");
				//fLED.rgb(255,   0,   0);
				break;
				case '運転情報':
				case '運転計画':
				case 'その他':
				$("#lineInformation2").text('時刻表通りに運転しないなどの可能性があります').css("color","slategray");
				//fLED.rgb(255, 255, 255);
			}
		});
	});
//}
</script>
<body>
	<div id="obniz-debug"></div>
	<h1>アラーム・運行情報通知板 設定画面</h1>
		<h2>各種設定画面</h2>
			<h3>１路線目</h3>
				<div>
				<label for="areaSelect1">地域を選んでください</label>
				<select name="area" id="areaSelect1">
					<option value="">--選択してください--</option>
					<option value="2">北海道</option>
					<option value="3">東北</option>
					<option value="4">関東</option>
					<option value="5">中部</option>
					<option value="6">近畿</option>
					<option value="7">九州</option>
					<option value="8">中国</option>
					<option value="9">四国</option>
				</select></div>
				<div>
				<label for="lineSelect1">路線を選んでください</label>
				<select name="line" id="lineSelect1"></select>
				<h3>２路線目</h3>
				<label for="areaSelect2">地域を選んでください</label>
				<select name="area" id="areaSelect2">
					<option value="">--選択してください--</option>
					<option value="2">北海道</option>
					<option value="3">東北</option>
					<option value="4">関東</option>
					<option value="5">中部</option>
					<option value="6">近畿</option>
					<option value="7">九州</option>
					<option value="8">中国</option>
					<option value="9">四国</option>
				</select></div>
				<label for="lineSelect2">路線を選んでください</label>
				<select name="line" id="lineSelect2"></select></div>
		<h2>設定中の情報</h2>
			<h3>１路線目</h3>
			<div id = areaSelected1>１路線目の地域：--選択してください--</div>
			<div id = lineSelected1>１路線目の名称：--選択してください--</div>
			<h4><div>運行情報</div></h4>
				<span id = lineCompany1>運営会社の</span><span id = lineName1>鉄道路線は</span><span id = lineInformation1>運行情報</span>
			<h3>２路線目</h3>
			<div id = areaSelected2>２路線目の地域：--選択してください--</div>
			<div id = lineSelected2>２路線目の名称：--選択してください--</div>
			<h4><div>運行情報</div></h4>
				<span id = lineCompany2>運営会社の</span><span id = lineName2>鉄道路線は</span><span id = lineInformation2>運行情報</span>
</body>
</html>
